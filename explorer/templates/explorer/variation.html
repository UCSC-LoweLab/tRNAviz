{% extends "base.html" %}
{% load static from staticfiles %}
{% load explorer_extras %}

{% block static %}
<script src="{% static 'js/jquery-ui.min.js' %}"></script>
<link rel="stylesheet" href="{% static 'css/jquery-ui.min.css' %}">
<script src="{% static 'explorer/js/tooltip.js' %}"></script>
<script src="{% static 'explorer/js/export.js' %}"></script>
<script src="{% static 'explorer/js/distributions.js' %}"></script>
<link rel="stylesheet" href="{% static 'explorer/css/explorer.css' %}">
{% endblock %}

{% block plotjs %}
<!-- js for loading tooltip -->
<script>
d3.json("{% url 'explorer:coords' %}", function(coords) {
	var circles = d3.select('#tooltip-cloverleaf')
		.append('svg')
		.attr('id', 'tooltip-cloverleaf-svg')
		.attr('width', 155)
		.attr('height', 160)
		.append('g')
		.selectAll('circle')
    .data(coords, d => 'circle' + d['position'])
    .enter()
    .append('circle')
    .attr('class', 'tooltip-cloverleaf-circle')
    .attr('id', d => 'circle' + d['position'])
    .attr('cx', d => d['x'] * 0.3)
    .attr('cy', d => d['y'] * 0.3)
    .attr('r', d => d['radius'] * 0.3);
});
</script>
{% endblock %}

{% block title %}tRNAviz | Variation{% endblock %}

{% block plots %}
<div class="plotbox-row">
	<div class="plotbox-outer">
		<div class="plotbox-header">
			<div class="download-box dropdown">
  			<a class="dropdown-toggle" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">Download</a>
  			<div class="dropdown-menu">
    			<a class="dropdown-item" href="#" id='distribution-download-pdf'>PDF</a>
  			</div>
  		</div>
			<h5>Sequence feature distribution</h5>
		</div>
		<div class="plotbox-inner" id="distribution-area">
			<div class="loading-overlay" style="margin-left: 10em; margin-right: 10em;"></div>
		</div>
	</div>
</div>

<div class="tooltip tooltip-distribution" style="opacity:0">
	<table class="table table-sm table-striped table-bordered table-light">
		<tbody>
			<tr>
				<th scope="col">Position</th>
				<td id="tooltip-position"></td>
				<td id="tooltip-cloverleaf" rowspan="6"></td>
			</tr>
			<tr>
				<th scope="col">Isotype</th>
				<td id="tooltip-isotype"></td>
			</tr>
			<tr>
				<th scope="col">Group</th>
				<td id="tooltip-group"></td>
			</tr>
			<tr>
				<th scope="col">Feature</th>
				<td id="tooltip-feature"></td>
			</tr>
			<tr>
				<th scope="col">Frequency</th>
				<td id="tooltip-freq"></td>
			</tr>
			<tr>
				<th scope="col">Count</th>
				<td id="tooltip-count"></td>
			</tr>
		</tbody>
	</table>
</div>

{% endblock %}